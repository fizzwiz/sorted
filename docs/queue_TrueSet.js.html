<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: queue/TrueSet.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: queue/TrueSet.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Queue } from "../core/Queue.js";
import { Classifier } from "./Classifier.js";
import { Each } from "@fizzwiz/fluent";

/**
 * A TrueSet is a multiset-like collection where item equivalence
 * is determined by a user-provided `repr(item)` function.
 *
 * Internally, the set stores elements inside a {@link Classifier} as:
 *     classifier.add(repr(item), item)
 *
 * Unlike a normal Set, equivalent items may coexist.  
 * Both classes (repr values) and the items inside each class are sorted
 * according to the sorting configuration of the underlying Classifier.
 *
 * This class exposes:
 *  - A Collection interface (add, remove, has, n, clear, iteration)
 *  - A Queue interface (peek, poll, reverse)
 *
 * The `.classifier` property is intentionally public so users may
 * inspect or query the internal structure.
 */
export class TrueSet extends Queue {

    /**
     * @param {function(*): *} repr  A function producing the class key for each item.
     * @param {Classifier} [classifier=new Classifier()]  The internal classifier.
     */
    constructor(repr, classifier = new Classifier()) {
        super();
        
        this.repr = item => Each.as(repr(item));
        this.classifier = classifier;
    }

    // -----------------------------------------------------------
    // Collection interface
    // -----------------------------------------------------------

    /** @returns {Iterator&lt;*>} Iterates stored items */
    [Symbol.iterator]() { 
        return this.classifier.values(); 
    }

    /** Total number of stored items */
    n() { 
        return this.classifier.n(); 
    }

    /**
     * @param {*} item
     * @returns {boolean} whether an equivalent item exists
     */
    has(item) { 
        return this.classifier.has(this.repr(item)); 
    }

    /**
     * Adds the item `xTimes` times.
     * @param {*} item 
     * @param {number} [xTimes=1]
     * @returns {this}
     */
    add(item, xTimes = 1) { 
        this.classifier.add(this.repr(item), item, xTimes);
        return this;
    }

    /**
     * Removes up to `xTimes` occurrences of the item.
     * @param {*} item 
     * @param {number} [xTimes=Infinity]
     * @returns {boolean} true if removal occurred
     */
    remove(item, xTimes = Infinity) { 
        return this.classifier.remove(this.repr(item), xTimes);
    }

    /** Remove all items */
    clear() { 
        this.classifier.clear(); 
    }

    /** Iterates all the equivalent items */
    get(item, first = true) {
        return this.classifier.get(this.repr(item), first)
    }

    // -----------------------------------------------------------
    // Queue interface
    // -----------------------------------------------------------

    /**
     * Returns (without removing) the first or last stored item.
     * @param {boolean} [first=true]
     * @returns {*} the peeked item or undefined
     */
    peek(first = true) { 
        const node = this.classifier.peek(first);
        return node;
    }

    /**
     * Returns an iterator of all items in reverse order.
     * @returns {Iterator&lt;*>}
     */
    reverse() { 
        return this.classifier.values(false); 
    }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-core.html">core</a></li><li><a href="module-global.html">global</a></li><li><a href="module-queue.html">queue</a></li></ul><h3>Namespaces</h3><ul><li><a href="ORDER.html">ORDER</a></li><li><a href="SORTER.html">SORTER</a></li></ul><h3>Classes</h3><ul><li><a href="ArrayQueue.html">ArrayQueue</a></li><li><a href="AsyncCollection.html">AsyncCollection</a></li><li><a href="Classifier.html">Classifier</a></li><li><a href="Collection.html">Collection</a></li><li><a href="Queue.html">Queue</a></li><li><a href="SortedArray.html">SortedArray</a></li><li><a href="TrueSet.html">TrueSet</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Tue Nov 18 2025 20:31:57 GMT+0100 (Ora standard dellâ€™Europa centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
